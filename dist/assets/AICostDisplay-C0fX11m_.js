import{c as R,u as S,r as d,j as e,R as w,C as A,t as $,v as k,w as z,x as q}from"./index-Bbx85iqt.js";/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=R("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);function T(){var m,u,h,g,f,j,p,N,v,y,b;const{token:l}=S(),[t,C]=d.useState(null),[M,o]=d.useState(!0),[c,i]=d.useState(null),x=async()=>{o(!0),i(null);try{const s=await fetch("/api/ai/usage",{headers:{Authorization:`Bearer ${l}`}});if(!s.ok)throw new Error("Failed to fetch usage");const n=await s.json();C(n)}catch(s){i(s.message)}finally{o(!1)}};d.useEffect(()=>{l&&x()},[l]);const r=s=>s===0?"$0.00":s<.01?"<$0.01":`$${s.toFixed(4)}`,a=s=>s>=1e6?`${(s/1e6).toFixed(1)}M`:s>=1e3?`${(s/1e3).toFixed(1)}K`:s.toString();return M?e.jsx("div",{className:"flex justify-center items-center p-8",children:e.jsx(w,{className:"animate-spin text-muted-foreground",size:24})}):c?e.jsxs("div",{className:"p-4 rounded-lg bg-destructive/10 text-destructive text-sm",children:["Failed to load usage data: ",c]}):t?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"p-4 rounded-lg border bg-card",children:[e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground text-xs mb-1",children:[e.jsx(A,{size:12}),"Today"]}),e.jsx("p",{className:"text-2xl font-bold",children:r(((m=t.today)==null?void 0:m.cost)||0)}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[((u=t.today)==null?void 0:u.requests)||0," requests 路 ",a(((h=t.today)==null?void 0:h.tokens)||0)," tokens"]})]}),e.jsxs("div",{className:"p-4 rounded-lg border bg-card",children:[e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground text-xs mb-1",children:[e.jsx($,{size:12}),"This Month"]}),e.jsx("p",{className:"text-2xl font-bold",children:r(((g=t.thisMonth)==null?void 0:g.cost)||0)}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[((f=t.thisMonth)==null?void 0:f.requests)||0," requests 路 ",a(((j=t.thisMonth)==null?void 0:j.tokens)||0)," tokens"]})]}),e.jsxs("div",{className:"p-4 rounded-lg border bg-card",children:[e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground text-xs mb-1",children:[e.jsx(F,{size:12}),"All Time"]}),e.jsx("p",{className:"text-2xl font-bold",children:r(((p=t.total)==null?void 0:p.cost)||0)}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[((N=t.total)==null?void 0:N.requests)||0," requests 路 ",a(((v=t.total)==null?void 0:v.tokens)||0)," tokens"]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium mb-3",children:"Cost by Model"}),e.jsx("div",{className:"rounded-lg border overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-muted/50 text-xs text-muted-foreground",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 text-left font-medium",children:"Model"}),e.jsx("th",{className:"px-3 py-2 text-right font-medium",children:"Requests"}),e.jsx("th",{className:"px-3 py-2 text-right font-medium",children:"Tokens"}),e.jsx("th",{className:"px-3 py-2 text-right font-medium",children:"Est. Cost"})]})}),e.jsx("tbody",{className:"divide-y",children:t.usageByModel&&t.usageByModel.length>0?t.usageByModel.map((s,n)=>e.jsxs("tr",{className:"bg-card hover:bg-muted/50 transition-colors",children:[e.jsx("td",{className:"px-3 py-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-5 h-5 rounded-full bg-muted flex items-center justify-center shrink-0",children:s.provider==="ollama"?e.jsx(k,{size:10,className:"text-green-500"}):e.jsx(z,{size:10,className:"text-blue-500"})}),e.jsx("span",{className:"font-medium truncate max-w-[150px] sm:max-w-[200px]",title:s.model,children:s.model||"Unknown model"})]})}),e.jsx("td",{className:"px-3 py-2 text-right text-muted-foreground",children:s.requests}),e.jsx("td",{className:"px-3 py-2 text-right text-muted-foreground",children:a(s.tokens)}),e.jsx("td",{className:"px-3 py-2 text-right font-medium",children:s.cost===0?e.jsx("span",{className:"text-green-500",children:"Free"}):r(s.cost)})]},n)):e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"px-3 py-4 text-center text-muted-foreground text-xs",children:"No usage data recorded yet."})})})]})})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-medium",children:"Recent Requests"}),e.jsxs("button",{onClick:x,className:"text-xs text-muted-foreground hover:text-foreground flex items-center gap-1",children:[e.jsx(w,{size:12}),"Refresh"]})]}),((y=t.recentRequests)==null?void 0:y.length)===0?e.jsx("div",{className:"p-6 rounded-lg border bg-muted/30 text-center text-sm text-muted-foreground",children:"No AI requests yet. Use Stack Analysis or AI Chat to get started."}):e.jsx("div",{className:"rounded-lg border divide-y overflow-hidden",children:(b=t.recentRequests)==null?void 0:b.map(s=>e.jsxs("div",{className:"p-3 text-sm flex items-center justify-between bg-card hover:bg-muted/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-muted flex items-center justify-center",children:s.provider==="ollama"?e.jsx(k,{size:12,className:"text-green-500"}):e.jsx(z,{size:12,className:"text-blue-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-xs",children:s.model||"Unknown model"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[s.request_type," 路 ",a(s.total_tokens||0)," tokens"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:`font-medium text-xs ${s.cost_usd===0?"text-green-500":""}`,children:s.cost_usd===0?"Free":r(s.cost_usd)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:new Date(s.created_at).toLocaleDateString()})]})]},s.id))})]}),e.jsx("div",{className:"p-3 rounded-lg bg-muted/50 border text-xs text-muted-foreground",children:e.jsxs("p",{className:"flex items-center gap-2",children:[e.jsx(q,{size:14}),e.jsxs("span",{children:[e.jsx("strong",{children:"Cost tracking:"})," OpenRouter requests show actual API costs. Ollama (local) requests are always free."]})]})})]}):null}export{T as AICostDisplay};
